<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>Tiles</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">



  <!-- <link rel="stylesheet" href="../shared/lib/reveal/../tabzilla/css/tabzilla.css"/> -->
  <link rel="stylesheet" href="../shared/lib/reveal/css/reveal.css"/>
  <link rel="stylesheet" href="../shared/lib/reveal/css/theme/mozilla-devrel-light.css"/>
  <link rel="stylesheet" href="../shared/lib/reveal/lib/css/solarized-light.css" />




  <!-- <link rel="stylesheet" href="../shared/lib/reveal/css/reveal.css"> -->

  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
<!--  -->
<!--   <link rel="stylesheet" href="../shared/lib/reveal/css/theme/black.css" id="theme"> -->
<!--  -->
<!--  -->
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? '../shared/lib/reveal/css/print/pdf.css' : '../shared/lib/reveal/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="../shared/lib/reveal/lib/js/html5shiv.js"></script>
  <![endif]-->


<!-- FIXME megahack because `pandoc` only generates h1's. -->
<!-- <style type="text/css"> -->


<!-- .inner { -->
<!--     width: 100%; -->
<!--     margin: 0 auto; --> 
<!-- } -->

<!--     h1{ --> 
<!--     } -->

<!--     .level2 h1 { -->
        
<!--     border-top: 0.1em solid #484848; -->
<!--     border-bottom: 0.1em solid #484848; -->
    
<!--     padding: 1em 0; -->
<!--     margin-bottom: 1em; -->
<!--     font-size: 1.6em; -->
<!--     margin: 0 0 20px 0; -->
<!--     color: #484848; -->
<!--     font-family: "Fira Sans", Helvetica, sans-serif; -->
<!--     font-weight: 600; -->
<!--     line-height: 1.2; -->
<!--     letter-spacing: normal; -->
<!--     text-transform: uppercase; -->
<!--     text-shadow: none; -->
<!--     word-wrap: break-word; -->
<!-- } -->

<!-- </style> -->


</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">Tiles</h1>
</section>

<section><section id="tiles" class="title-slide slide level1"><h1>Tiles</h1></section><section id="qué-es-un-tile" class="slide level2">
<h2>Qué es un tile</h2>
<p>Un <em>tile</em> es un imagen, generalmente cuadrada, y generalmente de tamaño fijo, que se usa para dibujar un elemento en un videojuego</p>
</section><section class="slide level2">

<p>Los tiles simplifican el desarrollo, ya que hacen que el mundo se considere <strong>una matriz discreta</strong></p>
</section><section class="slide level2">

<p>Los tiles pueden ser usados para dibujar (por ejemplo, el mapa o el fondo), y también <em>para la lógica del juego</em> (como en los <a href="https://es.wikipedia.org/wiki/Roguelike">roguelikes</a>).</p>
</section><section class="slide level2">

<figure>
<img data-src="https://upload.wikimedia.org/wikipedia/commons/2/29/Dungeon_crawl_stone_soup.png" alt="Dungeon Crawl" data-weight="50%" /><figcaption>Dungeon Crawl</figcaption>
</figure>
</section><section class="slide level2">

<p>Cada <em>tile</em> es una imagen particular, independiente</p>
<div class="fragment">
<p>… o no!</p>
<!-- # Tile sets -->
<!-- ## Qué es un tile set -->
<!-- Un **tile set** es una "hoja" en la que todos los tiles están dibujados, cada -->
<!-- uno en su celda correspondiente -->
<!-- --- -->
<!-- ![Ejemplo de tile set (Wikipedia)]() -->
</div>
</section></section>
<section><section id="tile-maps" class="title-slide slide level1"><h1>Tile maps</h1></section><section id="qué-es-un-tile-map" class="slide level2">
<h2>Qué es un tile map</h2>
<p>Un <strong>tile map</strong> es una simplificación de un mundo en 2D en la que dicho mundo es dividido en una cuadrícula de tamaño fijo (una matriz 2D)</p>
</section><section class="slide level2">

<p>En cada “celda” se pinta un tile, generalmente extraído de un <em>tile set</em></p>
<!-- Cada una de los rectángulos que forman la cuadrícula, en realidad representa un -->
<!-- fragmento o *frame* de un *spritesheet*. -->
</section><section id="partes-de-un-tile-map" class="slide level2">
<h2>Partes de un tile map</h2>
<p>Normalmente un tile map está compuesto por:</p>
<ul>
<li class="fragment">un fichero de datos con la definición del tile map</li>
<li class="fragment">su tamaño</li>
<li class="fragment">el tamaño de las casillas (tiles)</li>
<li class="fragment">una hoja de sprites con todos los tiles disponibles juntos</li>
<li class="fragment">frame concreto que debe visualizarse en cada casilla</li>
</ul>
</section><section id="ejemplo-de-tile-map" class="slide level2">
<h2>Ejemplo de tile map</h2>
<figure>
<img data-src="imgs/Tilemap_zelda.png" alt="TileMap del Zelda" style="height:75.0%" /><figcaption>TileMap del Zelda</figcaption>
</figure>
</section></section>
<section><section id="tile-sets" class="title-slide slide level1"><h1>Tile sets</h1></section><section class="slide level2">

<p>Un tile set se suele implementar como un archivo de imagen en el que cada celda representa un tile</p>
</section><section id="ejemplo-de-tile-set" class="slide level2">
<h2>Ejemplo de tile set</h2>
<figure>
<img data-src="imgs/Tileset_zelda.png" alt="Tileset" style="height:75.0%" /><figcaption>Tileset</figcaption>
</figure>
</section><section class="slide level2">

<p>Cada celda del tile set representa una imagen <em>independiente</em></p>
<div class="fragment">
<p>Esto funciona bien para cosas aisladas: monedas, árboles, cajas…</p>
</div>
</section><section class="slide level2">

<p>Pero no funciona bien en <strong>la playa</strong></p>
</section><section id="la-playa" class="slide level2">
<h2>La playa</h2>
<figure>
<img data-src="http://opengameart.org/sites/default/files/styles/medium/public/preview_128.png" alt="Tile set de “playa”" /><figcaption>Tile set de “playa”</figcaption>
</figure>
<p>(De <a href="http://opengameart.org/content/happyland-tileset" class="uri">http://opengameart.org/content/happyland-tileset</a>)</p>
</section><section class="slide level2">

<p>Para evitar los “cortes”, los tiles normalmente están creados para repetirse en la escena sin que se vean costuras, de forma que se pueden construir escenas muy complejas</p>
<p>Se ocupa <strong>mucha menos memoria</strong> que dibujando la escena en una imagen (se carga una, se usa muchas veces)</p>
</section><section id="por-qué-es-más-eficiente" class="slide level2">
<h2>¿Por qué es más eficiente?</h2>
<ul>
<li class="fragment">Escena de 4096x1024p, tiles de 64X64
<ul>
<li class="fragment">Sin tile map: 4096x1024x4Bytes de color = <strong>16.7MB</strong></li>
<li class="fragment">Con tile map: tile map de 64x16, tile set de 1024x1024 con 16x16 tiles = 256 tiles
<ul>
<li class="fragment">Tamaño del tile map = 1024Bytes</li>
<li class="fragment">Tamaño del tile set = 1024x1024x4 = 4 MB</li>
<li class="fragment">Tamaño total = <strong>4.01 MB</strong></li>
</ul></li>
</ul></li>
</ul>
</section><section id="otras-ventajas" class="slide level2">
<h2>Otras ventajas:</h2>
<ul>
<li class="fragment">Al tener todos los tiles en la misma hoja de scripts sólo necesitamos una Drawcall (llamada a pintado) para pintar todo el escenario</li>
<li class="fragment">Cuando cargamos desde Internet, es fundamental reducir los tiempos de carga (reducir el tamaño de los archivos ayuda) <!-- * En HTML5 es importante el peso de los archivos. Los tiempos de carga son mucho mayores que en una máquina local ya que hay que descargarse los datos desde el servidor --></li>
<li class="fragment">Dibujar la escena es más sencillo, sobre todo con un editor de tiles</li>
<li class="fragment">Podemos reutilizar tiles en diferentes escenarios.</li>
</ul>
</section><section class="slide level2">

<p>La desventaja es que los gráficos del escenario <strong>están repetidos</strong></p>
</section><section class="slide level2">

<p>(Pero periódicamente se pone de moda)</p>
</section></section>
<section><section id="editores-de-tiles" class="title-slide slide level1"><h1>Editores de tiles</h1></section><section id="por-qué-usarlos" class="slide level2">
<h2>¿Por qué usarlos?</h2>
<p>Nos simplifican la edición del tile map enormemente</p>
</section><section class="slide level2">

<p>Crear el tile map a mano es mucho mas complejo y propenso a errores</p>
</section><section id="tiled" class="slide level2">
<h2>Tiled</h2>
<p><a href="http://www.mapeditor.org/">Tiled</a> es un editor de niveles 2D que ayuda a desarrollar escenarios para juegos</p>
</section><section class="slide level2">

<p>Puede exportar a diferentes formatos, entre ellos el formato JSON que usa Phaser</p>
</section><section class="slide level2">

<p>Tiene soporte para diferentes capas (<strong>layers</strong>) e incluso para añadir una capa especial de objetos con la ubicación de los objetos en el mapa</p>
</section><section id="la-interfaz-de-tiled" class="slide level2">
<h2>La interfaz de Tiled</h2>
<figure>
<img data-src="imgs/tiled.png" alt="La interfaz de Tiled" /><figcaption>La interfaz de Tiled</figcaption>
</figure>
<p>##Partes de la interfaz de Tiled</p>
<ul>
<li class="fragment">Menu contextual (izquierda)</li>
<li class="fragment">Tilesets (derecha abajo)</li>
<li class="fragment">Layers (derecha arriba)</li>
<li class="fragment">Herramientas. (Parte superior)</li>
<li class="fragment">Zona de edicion (centro)</li>
</ul>
</section><section id="crear-un-nuevo-proyecto" class="slide level2">
<h2>Crear un nuevo proyecto</h2>
<p>Creamos un nuevo proyecto en <code>Archivo</code> &gt; <code>Nuevo</code> y aparecerá la ventana de creación del tile map</p>
</section><section class="slide level2">

<figure>
<img data-src="imgs/tiled_nuevo_proyecto.png" alt="Nuevo proyecto" style="width:40.0%" /><figcaption>Nuevo proyecto</figcaption>
</figure>
</section><section class="slide level2">

<p>Aquí establecemos el tamaño del patrón (tile) y el número de patrones que tendrá el nivel</p>
<p>Si queremos vista ortogonal o isométrica</p>
<p>Marcamos como base64 sin comprimir el formato de la capa de patrones</p>
</section><section id="vista-ortogonal-o-isométrica" class="slide level2">
<h2>Vista ortogonal o isométrica</h2>
<ul>
<li class="fragment">Base ortogonal es la tradicional en los juegos 2D (visto “desde arriba”)</li>
<li class="fragment">Base isométrica es una vista ortogonal especial que simula el 3D sin corrección de perspectiva
<ul>
<li class="fragment">Todos los ejes forman un ángulo de 120º. El dibujo se gira 45º para poner la esquina del escenario frente al espectador</li>
<li class="fragment">La cámara se situaría en la esquina superior</li>
</ul></li>
</ul>
</section><section class="slide level2">

<figure>
<img data-src="imgs/Perspectiva_isometrica.png" alt="Perspectiva isométrica" style="height:75.0%" /><figcaption>Perspectiva isométrica</figcaption>
</figure>
</section><section id="perspectiva-isométrica" class="slide level2">
<h2>Perspectiva isométrica</h2>
<figure>
<img data-src="imgs/isometrica.png" alt="Perspectiva isométrica" style="width:50.0%" /><figcaption>Perspectiva isométrica</figcaption>
</figure>
</section><section id="perspectiva-ortogonal" class="slide level2">
<h2>Perspectiva ortogonal</h2>
<figure>
<img data-src="imgs/ortogonal.png" alt="Perspectiva ortogonal" style="height:75.0%" /><figcaption>Perspectiva ortogonal</figcaption>
</figure>
</section><section id="añadir-un-tileset" class="slide level2">
<h2>Añadir un tileset</h2>
<p><img data-src="imgs/add_tileset.png" style="height:60.0%" /></p>
</section><section class="slide level2">

<p><strong>El nombre que le demos al tile set</strong> se usará posteriormente para cargar el spritesheet con los tiles en Phaser</p>
</section><section id="añadir-una-capa" class="slide level2">
<h2>Añadir una capa</h2>
<p>Podemos añadir nuevas capas</p>
<p>Las capas son importantes para diferenciar los objetos del fondo con los objetos del suelo</p>
</section><section class="slide level2">

<figure>
<img data-src="imgs/nueva_capa.png" alt="Añadir capas" style="height:75.0%" /><figcaption>Añadir capas</figcaption>
</figure>
</section><section id="exportar-el-mapa" class="slide level2">
<h2>Exportar el mapa</h2>
<p>Recomendable exportarlo a formato JSON</p>
</section></section>
<section><section id="tile-maps-en-phaser" class="title-slide slide level1"><h1>Tile maps en Phaser</h1></section><section id="cargar-el-tile-map" class="slide level2">
<h2>Cargar el tile map</h2>
<p>Para cargar el fichero de descripción del tile map, usamos <code class="sourceCode javascript"><span class="va">load</span>.<span class="at">tilemap</span></code></p>
<pre class="sourceCode js" id="cb1"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">this</span>.<span class="va">game</span>.<span class="va">load</span>.<span class="at">tilemap</span>(<span class="st">&#39;tilemap&#39;</span><span class="op">,</span> <span class="st">&#39;images/map.json&#39;</span><span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="va">Phaser</span>.<span class="va">Tilemap</span>.<span class="at">TILED_JSON</span>)<span class="op">;</span></a></code></pre>
</section><section class="slide level2">

<ul>
<li class="fragment">El primer parámetro es el nombre del recurso en la cache</li>
<li class="fragment">El segundo es el fichero JSON que contiene la descripción del mapa</li>
<li class="fragment">El tercer parámetro (si es distinto de <code class="sourceCode javascript"><span class="kw">null</span></code>) deberá contener el objeto JSON del mapa, ignorando el segundo parámetro</li>
<li class="fragment">El cuarto parámetro indica el tipo de fichero que puede ser: <code class="sourceCode javascript"><span class="va">Phaser</span>.<span class="va">Tilemap</span>.<span class="at">CSV</span></code> o <code class="sourceCode javascript"><span class="va">Phaser</span>.<span class="va">Tilemap</span>.<span class="at">TILED_JSON</span></code>.</li>
</ul>
</section><section class="slide level2">

<p>Para cargar el atlas de patrones usaremos la carga de imagenes normal: <code class="sourceCode javascript"><span class="va">load</span>.<span class="at">image</span></code></p>
<pre class="sourceCode js" id="cb2"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">this</span>.<span class="va">game</span>.<span class="va">load</span>.<span class="at">image</span>(<span class="st">&#39;patronesTilemap&#39;</span><span class="op">,</span> <span class="st">&#39;images/patrones.png&#39;</span>)<span class="op">;</span></a></code></pre>
</section><section id="crear-el-tile-map" class="slide level2">
<h2>Crear el tile map</h2>
<p>Para crear un tilemap usamos el recurso cargado en la cache como <em>tilemap</em></p>
<p>Una vez creado le asignamos la textura donde tenemos los tiles</p>
<pre class="sourceCode js" id="cb3"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">this</span>.<span class="at">map</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">game</span>.<span class="va">add</span>.<span class="at">tilemap</span>(<span class="st">&#39;tilemap&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">this</span>.<span class="va">map</span>.<span class="at">addTilesetImage</span>(<span class="st">&quot;patrones&quot;</span><span class="op">,</span><span class="st">&quot;patronesTilemap&quot;</span>)<span class="op">;</span></a></code></pre>
</section><section class="slide level2">

<p>La textura debe estar previamente cargada y el nombre de la textura en el mapa de tiles debe ser conocido</p>
<p>Un mapa de tiles puede tener más de una textura asociada, por lo que hay que asignar al nombre usado en el editor al asignar al tileset al nombre de la textura cargada en la cache</p>
</section><section id="crear-las-diferentes-capas" class="slide level2">
<h2>Crear las diferentes capas</h2>
<p>Como hemos visto, en el editor de tiles podemos crear diferentes capas o <em>layers</em></p>
<p>Una capa permite diferenciar los objetos del fondo con los objetos de frente o tener diferentes fondos para realizar “paralax”</p>
</section><section class="slide level2">

<p>Si hay capas creadas en el editor, podemos asignar estas capas (<em>layers</em>) en Phaser:</p>
<pre class="sourceCode js" id="cb4"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">this</span>.<span class="at">backgroundLayer</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">map</span>.<span class="at">createLayer</span>(<span class="st">&quot;BackgroundLayer&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">this</span>.<span class="at">groundLayer</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">map</span>.<span class="at">createLayer</span>(<span class="st">&quot;GroundLayer&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">this</span>.<span class="at">foreground</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">map</span>.<span class="at">createLayer</span>(<span class="st">&quot;Foreground&quot;</span>)<span class="op">;</span></a></code></pre>
</section><section id="re-escalar-el-tile-map." class="slide level2">
<h2>Re-escalar el tile map.</h2>
<p>Normalmente los tiles están a resoluciones bajas si queremos tener apariencia de juego retro de 8 o 16 bits</p>
<p>Así, los tiles muy pequeños en una resolución normal actual</p>
</section><section class="slide level2">

<p>La solución es escalarlos. Se pueden escalar de forma manual usando <code class="sourceCode javascript">setScale</code></p>
<pre class="sourceCode js" id="cb5"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" data-line-number="1">      <span class="kw">this</span>.<span class="va">groundLayer</span>.<span class="at">setScale</span>(<span class="dv">3</span><span class="op">,</span><span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">      <span class="kw">this</span>.<span class="va">backgroundLayer</span>.<span class="at">setScale</span>(<span class="dv">3</span><span class="op">,</span><span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">      <span class="kw">this</span>.<span class="va">death</span>.<span class="at">setScale</span>(<span class="dv">3</span><span class="op">,</span><span class="dv">3</span>)<span class="op">;</span></a></code></pre>
</section><section class="slide level2">

<p>Se pueden escalar de forma automática usando <code class="sourceCode javascript">resizeWorld</code></p>
<p>Con <code class="sourceCode javascript">resizeWorld</code> es muy recomendable que la resolución de pantalla sea proporcional a la resolución del tile map para que se adapte correctamente en altura y en anchura</p>
<pre class="sourceCode js" id="cb6"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">this</span>.<span class="va">backgroundLayer</span>.<span class="at">resizeWorld</span>()<span class="op">;</span></a></code></pre>
</section></section>
    </div>
  </div>

  <script src="../shared/lib/reveal/lib/js/head.min.js"></script>
  <script src="../shared/lib/reveal/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({

        // Optional reveal.js plugins
        dependencies: [
          { src: '../shared/lib/reveal/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: '../shared/lib/reveal/plugin/zoom-js/zoom.js', async: true },
          { src: '../shared/lib/reveal/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
